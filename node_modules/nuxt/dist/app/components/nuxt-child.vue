<template>
  <transition :name="transition.name" :mode="transition.mode">
    <router-view :key="nkey"></router-view>
  </transition>
</template>

<script>
import Vue from 'vue'

export default {
  name: 'nuxt-child',
  beforeCreate () {
    Vue.util.defineReactive(this, 'nuxt', this.$root.$options._nuxt)
    this._deep = 0
    let parent = this
    while (parent !== this.$nuxt) {
      if (parent.$options._componentTag === 'nuxt-child') {
        this._deep++
      }
      parent = parent.$parent
    }
  },
  computed: {
    transition () {
      console.log('Transition', this.nkey, this._deep, this.nuxt.transitions[this._deep] || this.nuxt.defaultTransition);
      return this.nuxt.transitions[this._deep] || this.nuxt.defaultTransition
    }
  },
  props: {
    nkey: {
      type: String,
      default: ''
    }
  }
  // props: {
  //   transition: {
  //     type: Object,
  //     default: () => {
  //       return {
  //         hooks: false,
  //         mode: 'out-in', // out-in ou in-out
  //         name: 'fade',
  //         type: '', // animation ou transition
  //         enterClass: '',
  //         enterActiveClass: '',
  //         leaveClass: '',
  //         leaveActiveClass: '',
  //         beforeEnter: null, // Func
  //         enter: null,
  //         afterEnter: null,
  //         enterCancelled: null,
  //         beforeLeave: null,
  //         leave: null,
  //         afterLeave: null,
  //         leaveCancelled: null
  //       }
  //     }
  //   }
  // }
}
</script>
